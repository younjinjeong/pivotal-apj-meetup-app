<!DOCTYPE HTML>
<html>
<head>
	<title>EMC Forum 2016</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
	<link rel="stylesheet" href="assets/css/main.css" />
	<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
	<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
</head>
<body>


<!-- Wrapper -->
<div id="wrapper">
	<!-- Banner -->
	<section id="banner" class="major">
		<div class="inner">
			<header class="major">
				<h1>Competition Time</h1>
				<h1>有獎問答遊戲</h1>
			</header>
		</div>
	</section>

	<!-- Main -->
	<div id="main">

		<section id="two" class="tiles">
			<div class="inner">


				<h2 class="q1">Q1: It seems every company today is racing to transform into a software company.  What are the major reasons for this?</h2>

				<div class="12u 12u$(small) q1" id="q1_block">
					<div id="q1_answers">
						<div class="4u 12u$(small)">
							<input type="radio" id="q1_a" name="q1" value="a">
							<label for="q1_a">Pressure coming from Internet and startups competitors</label>
						</div>
						<div class="4u 12u$(small)">
							<input type="radio" id="q1_b" name="q1" value="b">
							<label for="q1_b">Digital is all about software development</label>
						</div>
						<div class="4u$ 12u$(small)">
							<input type="radio" id="q1_c" name="q1" value="c">
							<label for="q1_c">Outsourcing cannot give you competitive advantage</label>
						</div>
						<div class="4u$ 12u$(small)">
							<input type="radio" id="q1_d" name="q1" value="d">
							<label for="q1_d">All of the above</label>
						</div>
					</div>
					<canvas id="q1Chart" ></canvas>
				</div>


				<h2 class="q2">Q2: In Digital Transformation, which three key areas are most important?</h2>
				<div class="12u 12u$(small) q2" id="q2_block">
					<div id="q2_answers">
						<div class="4u 12u$(small)">
							<input type="radio" id="q2_a" name="q2" value="a">
							<label for="q2_a">Workforce, security and IT process</label>
						</div>
						<div class="4u 12u$(small)">
							<input type="radio" id="q2_b" name="q2" value="b">
							<label for="q2_b">Big data, cloud native platform and agile culture</label>
						</div>
						<div class="4u$ 12u$(small)">
							<input type="radio" id="q2_c" name="q2" value="c">
							<label for="q2_c">Infrastructure, automation and data center efficiency</label>
						</div>
					</div>

					<canvas id="q2Chart" ></canvas>
				</div>

				<h2 class="q3">Q3: What are the four technology pillars in today’s modern data center?</h2>
				<div class="12u 12u$(small) q3" id="q3_block">
					<div id="q3_answers">
						<div class="4u 12u$(small)">
							<input type="radio" id="q3_a" name="q3" value="a">
							<label for="q3_a">Flash, converged infrastructure, virtualization, adaptive security</label>
						</div>
						<div class="4u 12u$(small)">
							<input type="radio" id="q3_b" name="q3" value="b">
							<label for="q3_b">Flash, cloud enabled, scale out, software defined</label>
						</div>
						<div class="4u$ 12u$(small)">
							<input type="radio" id="q3_c" name="q3" value="c">
							<label for="q3_c">Flash, virtualization, scale out, protection</label>
						</div>
					</div>
					<canvas id="q3Chart" ></canvas>
				</div>

				<h2 class="q4">Q4: Which are the key components of Enterprise hybrid cloud?</h2>
				<div class="12u 12u$(small) q4" id="q4_block">
					<div id="q4_answers">
						<div class="4u 12u$(small)">
							<input type="radio" id="q4_a" name="q4" value="a">
							<label for="q4_a">Virtualized compute, storage and network</label>
						</div>
						<div class="4u 12u$(small)">
							<input type="radio" id="q4_b" name="q4" value="b">
							<label for="q4_b">Converged infrastructure, scale out storage</label>
						</div>
						<div class="4u$ 12u$(small)">
							<input type="radio" id="q4_c" name="q4" value="c">
							<label for="q4_c">Modernized architecture, automated service delivery & management</label>
						</div>
					</div>
					<canvas id="q4Chart" ></canvas>
				</div>

				<h2 class="q5">Q5: According to analyst research, how much cost efficiency can be gained by moving to a hybrid cloud model?</h2>
				<div class="12u 12u$(small) q5" id="q5_block">
					<div id="q5_answers">
						<div class="4u 12u$(small)">
							<input type="radio" id="q5_a" name="q5" value="a">
							<label for="q5_a">20%</label>
						</div>
						<div class="4u 12u$(small)">
							<input type="radio" id="q5_b" name="q5" value="b">
							<label for="q5_b">24%</label>
						</div>
						<div class="4u$ 12u$(small)">
							<input type="radio" id="q5_c" name="q5" value="c">
							<label for="q5_c">28%</label>
						</div>
						<div class="4u$ 12u$(small)">
							<input type="radio" id="q5_d" name="q5" value="d">
							<label for="q5_d">35%</label>
						</div>
					</div>
					<canvas id="q5Chart" ></canvas>
				</div>

				<div class="12u$">
					<ul class="actions">
						<li>
							<input id="start" type="button" value="Start" class="special" />
							<!--<input id="previous" type="button" value="Previous" class="special" />-->
							<input id="next" type="button" value="Next" class="special" />
							<input id="result" type="button" value="Result" class="special" onclick="window.location.href='/admin/result.html'"/>
						</li>
					</ul>
				</div>
			</div>
		</section>

	</div>

</div>

<!-- Scripts -->
<script src="assets/js/Chart.js"></script>
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/jquery.scrolly.min.js"></script>
<script src="assets/js/jquery.scrollex.min.js"></script>
<script src="assets/js/skel.min.js"></script>
<script src="assets/js/util.js"></script>
<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
<script src="assets/js/main.js"></script>
<script>
	var answers = [
		["Pressure coming from Internet and startups competitors",
			"Digital is all about software development",
			"Outsourcing cannot give you competitive advantage",
			"All of the above"],
		["Workforce, security and IT process",
			"Big data, cloud native platform and agile culture",
			"Infrastructure, automation and data center efficiency"],
		["Flash, converged infrastructure, virtualization, adaptive security",
			"Flash, cloud enabled, scale out, software defined",
			"Flash, virtualization, scale out, protection"],
		["Virtualized compute, storage and network",
			"Converged infrastructure, scale out storage",
			"Modernized architecture, automated service delivery & management"],
		["20%", "24%", "28%", "35%"]
	];

	$(document).ready(function() {

		var currentQuestion = 1;
		var showedAnswer = false;
		var maxQuestion = 5;
		var started = false;
		var local = false;


		$(document).keydown(function(e){
			if (e.keyCode == 37) {
				previous();
			}else if (e.keyCode == 39) {
				next();
			}
		});

		function filterAnswer(data, answer){
			var result = 0;
			try {
				result = $.grep(data, function (n, i) {
					return n.answer == answer;
				})[0].count;
			}catch (err){}
			return result;
		}

		function startGame() {
			$("#banner").hide();
			$("#start").hide();
			$(".q1").show();
			$("#next").show();
			started = true;
		}

		function previous(){
			if(!started) return;
			if(currentQuestion==1) return;
			$("#next").show();
			$("#result").hide();
			$(".q" + currentQuestion--).hide();
			$(".q" + currentQuestion).show();
			if(currentQuestion==1) $("#previous").hide();
			setChart(currentQuestion);
			showedAnswer = true;
		}

		function next(){
			if(!started) return;
			if(currentQuestion==maxQuestion && showedAnswer) return;
			if(!showedAnswer) {
				setChart(currentQuestion);
				showedAnswer = true;
				if(currentQuestion==maxQuestion) {
					$("#next").hide();
					$("#result").show();
				}
				return;
			}

			showedAnswer = false;
			$("#previous").show();
			$(".q" + currentQuestion++).hide();
//			$("#q"+currentQuestion+"_block").hide();
			$(".q" + currentQuestion).show();
		}

		$("#previous").on('click', previous);
		$("#next").on('click', next);
		$("#result").hide();
		$("#previous").hide();
		$("#next").hide();
		$("#start").on('click', startGame);


		for(var i=1;i<=maxQuestion;i++){
			$(".q" + i).hide();
		}

		var backgroundColor =  [
			'rgba(255, 99, 132, 1)',
			'rgba(54, 162, 235, 1)',
			'rgba(255, 206, 86, 1)',
			'rgba(75, 192, 192, 1)',
			'rgba(153, 102, 255, 1)',
			'rgba(255, 159, 64, 1)'
		];
		var borderColor =  [
			'rgba(255,99,132,1)',
			'rgba(54, 162, 235, 1)',
			'rgba(255, 206, 86, 1)',
			'rgba(75, 192, 192, 1)',
			'rgba(153, 102, 255, 1)',
			'rgba(255, 159, 64, 1)'
		];
		var borderWidth = 1;

		function setAnswer(data, i){
			try {
				if (answers[i].length == 3) {
					return [filterAnswer(data, 'a'), filterAnswer(data, 'b'), filterAnswer(data, 'c')];
				} else if (answers[i].length == 4) {
					return [filterAnswer(data, 'a'), filterAnswer(data, 'b'), filterAnswer(data, 'c'), filterAnswer(data, 'd')];
				}
			}catch(err){

			}
			return;
		}

		Chart.pluginService.register({
			beforeRender: function (chart) {
				if (chart.config.options.showAllTooltips) {
					// create an array of tooltips
					// we can't use the chart tooltip because there is only one tooltip per chart
					chart.pluginTooltips = [];
					chart.config.data.datasets.forEach(function (dataset, i) {
						chart.getDatasetMeta(i).data.forEach(function (sector, j) {
							chart.pluginTooltips.push(new Chart.Tooltip({
								_chart: chart.chart,
								_chartInstance: chart,
								_data: chart.data,
								_options: chart.options.tooltips,
								_active: [sector]
							}, chart));
						});
					});

					// turn off normal tooltips
					chart.options.tooltips.enabled = false;
				}
			},
			afterDraw: function (chart, easing) {
				if (chart.config.options.showAllTooltips) {
					// we don't want the permanent tooltips to animate, so don't do anything till the animation runs atleast once
					if (!chart.allTooltipsOnce) {
						if (easing !== 1)
							return;
						chart.allTooltipsOnce = true;
					}

					// turn on tooltips
					chart.options.tooltips.enabled = true;
					Chart.helpers.each(chart.pluginTooltips, function (tooltip) {
						tooltip.initialize();
						tooltip.update();
						// we don't actually need this since we are not animating tooltips
						tooltip.pivot();
						tooltip.transition(easing).draw();
					});
					chart.options.tooltips.enabled = false;
				}
			}
		});

		function drawChart(i, data){
			var myChart = new Chart($("#q" + i + "Chart"), {
				type: 'doughnut',
				data: {
					labels: answers[i-1],
					datasets: [{
						label: 'Answers',
						data: setAnswer(data, i-1),
						backgroundColor: backgroundColor,
						borderColor: borderColor,
						borderWidth: borderWidth
					}]
				},
				options: {
					showAllTooltips: true,
					tooltips:{
						bodyFontSize: 24,
						backgroundColor: 'rgba(0,0,0,0.6)',

						callbacks: {
							label: function(tooltipItem, data) {
								var allData = data.datasets[tooltipItem.datasetIndex].data;
								var tooltipLabel = data.labels[tooltipItem.index];
								var tooltipData = allData[tooltipItem.index];
								var total = 0;
								for (var i in allData) {
									total += allData[i];
								}
								var tooltipPercentage = Math.round((tooltipData / total) * 100);
								return tooltipLabel + ': ' + tooltipData + ' (' + tooltipPercentage + '%)';
							}
						}
					},
					legend:{
						display: false,
						labels:{
							fontSize:18,
							fontColor: '#FFF'
						}
					}
				}
			});
		}

		function setChart(i){
			if(local) {
				drawChart(i, [{answer:'a',count:10},{answer:'b',count:20},{answer:'c',count:18},{answer:'d',count:14}]);
				$("#q"+i+"_answers").hide();
				return;
			}
			$.get( "/repository/getStats/q" + i, function( data ) {
				drawChart(i, data);
				$("#q"+i+"_answers").hide();
			}, "json" );
		}

	});

</script>
</body>
</html>